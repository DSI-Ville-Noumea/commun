language: java
jdk:
- oraclejdk8
cache:
  directories:
  - $HOME/.m2
before_install:
- export TZ=Pacific/Noumea
install: mvn clean install checksum:files -Dmaven.javadoc.skip=true -B -V
notifications:
  slack: dsi-mairie-noumea:MxlOz1t5uMHw8BYH0qjlv0R1
before_deploy:
- export RELEASE_PKG_FILE=$(ls target/*.jar)
- export RELEASE_PKG_MD5_FILE=$(ls target/*.jar.md5)
- export RELEASE_PKG_SHA_FILE=$(ls target/*.jar.sha1)
- echo "deploying $RELEASE_PKG_FILE , $RELEASE_PKG_MD5_FILE , $RELEASE_PKG_SHA_FILE
  to GitHub releases"
deploy:
  provider: releases
  api_key:
    secure: iMmHeoaltk4vkyyE1SWR/LbkHXDF8Xg5e/aJFldb0cJ4K5ivui1Wmzyu82DaDgeR1pkmftRtrGvI4Tcufyo9W00WwH/y6BbUeIEELZzR/tCypE5P/GKRO6/UGbi6lq0Pj/oG8f9GNVFhW+jDr/8jsr1ifErEF9ygWiyD6fwOv0EPAwr5NirAjOspZrsX7UZg9iXTwEGeITgTLi/4AB8XKi7hgDAqJibXchDdJ618brc4Hg/HzVyCy9CbXrAkSTD26PH4Gmq2u68Xga9RDCzT4I1lSfgiXc0Yp8WKbKWFM45kwzYW6nWLEvqXl7Fd+PYXraWD7/wojom9R/B33hO/txFz6r5d0P/A3BOtF15LNIVG9p/UaZ5yg6WQI6mFkLOndYi1o1lxyokAOxNmtucX4kYOaVGcZ/iz+UetAfG/7N+pnZoi7xe5t2EF1K6FRmmxQQhoxtVUY1ZjLIjFb0uVKfaMBzMy/p8z66OBKFDc3enTTiqSduB1A3aFGpf6GGiX/OiFh9PnqZw2KrO24CE7nhXCiRuz0c4QWbD6NNzNnw3BjcEWofVlQDxrrveDAlQIRzfsDFHvz7OvLuHl9WnGSw+TC32pfAX8yE7wm5waBjcta4aV6ccnYbHY/+oypTE4fAcHs/6cUKtC+0eR1LGt/TRPJ9G/zPfyo+z+2D3eMw0=
  file:
  - "${RELEASE_PKG_FILE}"
  - "${RELEASE_PKG_MD5_FILE}"
  - "${RELEASE_PKG_SHA_FILE}"
  skip_cleanup: true
  on:
    tags: true
  on:
    repo: DSI-Ville-Noumea/commun
